<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Daily Quests - Bobrashov</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { background: #000; color: #fff; font-family: Georgia, serif; padding: 2rem; max-width: 700px; margin: 0 auto; line-height: 1.6; }
        .header { text-align: center; margin-bottom: 3rem; }
        .title { font-size: 2.5rem; margin-bottom: 0.5rem; }
        .subtitle { opacity: 0.8; font-style: italic; }
        .stats { display: flex; justify-content: space-between; margin-bottom: 3rem; }
        .stat { text-align: center; }
        .stat-value { font-size: 2rem; margin-bottom: 0.3rem; }
        .stat-label { opacity: 0.8; font-size: 0.9rem; }
        .progress { margin-bottom: 3rem; }
        .progress-info { display: flex; justify-content: space-between; margin-bottom: 0.5rem; }
        .progress-bar { width: 100%; height: 15px; background: #222; border: 1px solid #333; }
        .progress-fill { height: 100%; background: #666; width: 0%; transition: width 0.3s; }
        .quest { background: #111; border: 1px solid #333; padding: 1.5rem; margin-bottom: 1rem; }
        .quest.done { opacity: 0.6; }
        .quest-header { display: flex; justify-content: space-between; margin-bottom: 1rem; }
        .quest-title { font-size: 1.2rem; }
        .quest-xp { background: #333; padding: 0.2rem 0.6rem; font-size: 0.8rem; }
        .quest-target { text-align: center; font-size: 1.5rem; margin: 1rem 0; }
        .btn { background: transparent; border: 1px solid #666; color: #fff; padding: 0.6rem 1rem; cursor: pointer; font-family: inherit; }
        .btn:hover { background: #333; }
        .btn:disabled { opacity: 0.5; cursor: not-allowed; }
        .reset { text-align: center; margin-top: 2rem; padding-top: 2rem; border-top: 1px solid #333; }
        .reset-btn { background: transparent; border: 1px solid #444; color: #888; padding: 0.4rem 0.8rem; cursor: pointer; font-family: inherit; font-size: 0.8rem; }
        .celebration { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: #222; border: 2px solid #666; padding: 2rem; text-align: center; opacity: 0; transition: opacity 0.3s; }
        .celebration.show { opacity: 1; }
        .nav { text-align: center; margin-bottom: 2rem; padding-bottom: 1rem; border-bottom: 1px solid #333; }
        .nav a { color: #ccc; text-decoration: none; margin: 0 1rem; font-size: 0.9rem; }
        .nav a:hover { color: #fff; }
        @media (max-width: 600px) { body { padding: 1rem; } .stats { flex-wrap: wrap; gap: 1rem; } .title { font-size: 2rem; } }
    </style>
</head>
<body>
    <nav class="nav">
        <a href="quest-editor.html">Quest Editor</a>
        <a href="index.html">Home</a>
    </nav>

    <header class="header">
        <h1 class="title">Daily Quests</h1>
        <p class="subtitle">Level up through discipline</p>
    </header>

    <section class="stats">
        <div class="stat">
            <div class="stat-value" id="level">1</div>
            <div class="stat-label">Level</div>
        </div>
        <div class="stat">
            <div class="stat-value" id="xp">0</div>
            <div class="stat-label">Total XP</div>
        </div>
        <div class="stat">
            <div class="stat-value" id="streak">0</div>
            <div class="stat-label">Streak</div>
        </div>
    </section>

    <section class="progress">
        <div class="progress-info">
            <span>Level <span id="lv">1</span></span>
            <span><span id="cur">0</span>/<span id="need">100</span> XP</span>
        </div>
        <div class="progress-bar">
            <div class="progress-fill" id="bar"></div>
        </div>
    </section>

    <section id="quests">
        <!-- Quests are loaded dynamically -->
    </section>

    <div class="reset">
        <button class="reset-btn" onclick="reset()">Reset Progress</button>
    </div>

    <div class="celebration" id="celebrate">
        <h2>Level Up!</h2>
        <p>Level <span id="newlv"></span> Achieved</p>
        <button class="btn" onclick="hide()">Continue</button>
    </div>

    <script>
        let s = {lv:1,xp:0,cur:0,need:100,streak:0,done:[],last:null};
        let quests = [];
        
        function loadQuests() {
            let custom = localStorage.getItem('bq-custom');
            if (!custom) {
                // Create default quests as custom quests on first run
                let defaults = [
                    {name:'Physical Training',target:'Push-ups',xp:50,desc:'Daily physical exercise'},
                    {name:'Mental Focus',target:'Min Reading',xp:30,desc:'Reading for mental growth'},
                    {name:'Inner Peace',target:'Min Meditation',xp:25,desc:'Mindfulness practice'}
                ];
                localStorage.setItem('bq-custom', JSON.stringify(defaults));
                custom = JSON.stringify(defaults);
            }
            
            let customQuests = JSON.parse(custom);
            quests = customQuests.map(q => ({
                name: q.name,
                target: q.target,
                baseTarget: q.name === 'Physical Training' ? 15 : (q.name === 'Mental Focus' ? 20 : 10),
                xp: q.xp,
                desc: q.desc
            }));
            s.done = new Array(quests.length).fill(0);
        }
        
        function load() {
            let saved = localStorage.getItem('bq');
            if (saved) {
                s = {...s, ...JSON.parse(saved)};
                let today = new Date().toDateString();
                if (s.last !== today) {
                    s.done = new Array(quests.length).fill(0);
                    if (s.last && (new Date(today) - new Date(s.last)) / 86400000 > 1) {
                        s.streak = 0;
                    }
                }
            }
        }
        
        function save() { localStorage.setItem('bq', JSON.stringify(s)); }
        
        function renderQuests() {
            let html = '';
            quests.forEach((q, i) => {
                let target = q.name === 'Physical Training' ? 
                    (15 + Math.floor((s.lv-1) * 3)) + ' ' + q.target :
                    q.baseTarget + ' ' + q.target;
                let xp = q.name === 'Physical Training' ? 
                    (50 + (s.lv-1)*5) : q.xp;
                let done = s.done[i];
                
                html += `
                    <div class="quest ${done ? 'done' : ''}" id="q${i+1}">
                        <div class="quest-header">
                            <h3 class="quest-title">${q.name}</h3>
                            <span class="quest-xp">+${xp} XP</span>
                        </div>
                        <div class="quest-target">${target}</div>
                        <button class="btn" onclick="complete(${i})" ${done ? 'disabled' : ''}>
                            ${done ? 'Done âœ“' : 'Complete'}
                        </button>
                    </div>
                `;
            });
            document.getElementById('quests').innerHTML = html;
        }
        
        function update() {
            document.getElementById('level').textContent = s.lv;
            document.getElementById('xp').textContent = s.xp;
            document.getElementById('streak').textContent = s.streak;
            document.getElementById('lv').textContent = s.lv;
            document.getElementById('cur').textContent = s.cur;
            document.getElementById('need').textContent = s.need;
            document.getElementById('bar').style.width = (s.cur/s.need*100) + '%';
            renderQuests();
        }
        
        function complete(i) {
            if (s.done[i]) return;
            let xp = quests[i].name === 'Physical Training' ? 
                (50 + (s.lv-1)*5) : quests[i].xp;
            s.done[i] = 1;
            s.xp += xp;
            s.cur += xp;
            s.last = new Date().toDateString();
            
            if (s.cur >= s.need) {
                s.cur -= s.need;
                s.lv++;
                s.need = Math.floor(100 * Math.pow(1.2, s.lv-1));
                document.getElementById('newlv').textContent = s.lv;
                document.getElementById('celebrate').classList.add('show');
            }
            
            if (s.done.every(x => x)) s.streak++;
            save();
            update();
        }
        
        function hide() { document.getElementById('celebrate').classList.remove('show'); }
        
        function reset() {
            if (confirm('Reset all progress?')) {
                localStorage.removeItem('bq');
                s = {lv:1,xp:0,cur:0,need:100,streak:0,done:new Array(quests.length).fill(0),last:null};
                update();
            }
        }
        
        loadQuests();
        load();
        update();
    </script>
</body>
</html>