<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reward Editor - Bobrashov</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { background: #000; color: #fff; font-family: Georgia, serif; padding: 2rem; max-width: 700px; margin: 0 auto; line-height: 1.6; }
        .header { text-align: center; margin-bottom: 3rem; }
        .title { font-size: 2.5rem; margin-bottom: 0.5rem; }
        .subtitle { opacity: 0.8; font-style: italic; }
        .nav { text-align: center; margin-bottom: 2rem; padding-bottom: 1rem; border-bottom: 1px solid #333; }
        .nav a { color: #ccc; text-decoration: none; margin: 0 1rem; font-size: 0.9rem; }
        .nav a:hover { color: #fff; }
        .editor { background: #111; border: 1px solid #333; padding: 2rem; margin-bottom: 2rem; }
        .form-row { margin-bottom: 1.5rem; }
        .label { display: block; margin-bottom: 0.5rem; opacity: 0.9; }
        .input, .textarea { width: 100%; background: #222; border: 1px solid #444; color: #fff; padding: 0.7rem; font-family: inherit; }
        .input:focus, .textarea:focus { outline: none; border-color: #666; }
        .textarea { height: 80px; resize: vertical; }
        .form-grid { display: grid; grid-template-columns: 2fr 1fr; gap: 1rem; }
        .btn { background: transparent; border: 1px solid #666; color: #fff; padding: 0.7rem 1.2rem; cursor: pointer; font-family: inherit; }
        .btn:hover { background: #333; }
        .btn.primary { background: #333; border-color: #999; }
        .reward-list { margin-bottom: 2rem; }
        .reward-item { background: #111; border: 1px solid #333; padding: 1rem; margin-bottom: 1rem; }
        .reward-item.purchased { opacity: 0.6; border-color: #4a8; }
        .reward-item-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem; }
        .reward-name { font-size: 1.1rem; }
        .reward-price { background: #333; padding: 0.2rem 0.5rem; font-size: 0.8rem; color: #ffd700; }
        .reward-desc { opacity: 0.8; font-size: 0.9rem; margin-bottom: 0.5rem; }
        .reward-category { opacity: 0.6; font-size: 0.8rem; margin-bottom: 0.5rem; }
        .reward-actions { display: flex; gap: 0.5rem; }
        .btn-small { padding: 0.3rem 0.6rem; font-size: 0.8rem; }
        .btn-danger { border-color: #644; color: #faa; }
        .btn-danger:hover { background: #422; }
        .empty { text-align: center; opacity: 0.6; padding: 2rem; }
        .defaults { margin-bottom: 2rem; }
        .default-item { background: #0a0a0a; border: 1px solid #2a2a2a; padding: 1rem; margin-bottom: 0.5rem; cursor: pointer; }
        .default-item:hover { border-color: #444; }
        .purchased-badge { color: #4a8; font-size: 0.8rem; margin-left: 0.5rem; }
        @media (max-width: 600px) { body { padding: 1rem; } .title { font-size: 2rem; } .form-grid { grid-template-columns: 1fr; } .reward-actions { flex-direction: column; } }
    </style>
</head>
<body>
    <nav class="nav">
        <a href="quest-shop.html">← Back to Shop</a>
        <a href="daily-quests.html">Daily Quests</a>
        <a href="quest-editor.html">Quest Editor</a>
        <a href="index.html">Home</a>
    </nav>

    <header class="header">
        <h1 class="title">Reward Editor</h1>
        <p class="subtitle">Create and manage your rewards</p>
    </header>

    <section class="defaults">
        <h2 style="margin-bottom: 1rem; border-bottom: 1px solid #333; padding-bottom: 0.5rem;">Quick Templates</h2>
        <div class="default-item" onclick="useTemplate('Cheat Day', 'Enjoy a guilt-free indulgence day', 'Food & Treats', 200)">
            <strong>Cheat Day</strong> • Food & Treats • 200 XP
        </div>
        <div class="default-item" onclick="useTemplate('Movie Night', 'Watch a movie without feeling guilty', 'Entertainment', 150)">
            <strong>Movie Night</strong> • Entertainment • 150 XP
        </div>
        <div class="default-item" onclick="useTemplate('Sleep In', 'Skip morning routine and sleep late', 'Comfort', 100)">
            <strong>Sleep In</strong> • Comfort • 100 XP
        </div>
        <div class="default-item" onclick="useTemplate('Gaming Session', '2 hours of unlimited gaming', 'Entertainment', 250)">
            <strong>Gaming Session</strong> • Entertainment • 250 XP
        </div>
        <div class="default-item" onclick="useTemplate('Shopping Spree', 'Buy something nice for yourself', 'Material', 300)">
            <strong>Shopping Spree</strong> • Material • 300 XP
        </div>
        <div class="default-item" onclick="useTemplate('Social Media Free Day', 'A day without social media distractions', 'Digital Detox', 180)">
            <strong>Social Media Free Day</strong> • Digital Detox • 180 XP
        </div>
    </section>

    <section class="editor">
        <h2 style="margin-bottom: 1.5rem;">Create New Reward</h2>
        <div class="form-row">
            <label class="label">Reward Name</label>
            <input type="text" class="input" id="itemName" placeholder="e.g., Pizza Night">
        </div>
        <div class="form-row">
            <label class="label">Description</label>
            <textarea class="textarea" id="itemDesc" placeholder="What reward do you get?"></textarea>
        </div>
        <div class="form-row">
            <div class="form-grid">
                <div>
                    <label class="label">Category</label>
                    <input type="text" class="input" id="itemCategory" placeholder="e.g., Food, Entertainment">
                </div>
                <div>
                    <label class="label">XP Cost</label>
                    <input type="number" class="input" id="itemPrice" value="100" min="50" max="1000">
                </div>
            </div>
        </div>
        <div class="form-row">
            <button class="btn primary" onclick="addItem()">Add Reward</button>
            <button class="btn" onclick="clearForm()" id="clearBtn">Clear</button>
        </div>
    </section>

    <section class="reward-list">
        <h2 style="margin-bottom: 1.5rem; border-bottom: 1px solid #333; padding-bottom: 0.5rem;">Your Rewards</h2>
        <div id="rewardList"></div>
    </section>

    <script>
        let shopItems = [];
        let editingItemId = null;
        
        function load() {
            let saved = localStorage.getItem('bq-shop');
            if (saved) shopItems = JSON.parse(saved);
            updateList();
        }
        
        function save() {
            localStorage.setItem('bq-shop', JSON.stringify(shopItems));
        }
        
        function addItem() {
            let name = document.getElementById('itemName').value.trim();
            let desc = document.getElementById('itemDesc').value.trim();
            let category = document.getElementById('itemCategory').value.trim();
            let price = parseInt(document.getElementById('itemPrice').value) || 100;
            
            if (!name || !desc) {
                alert('Please fill in reward name and description');
                return;
            }
            
            if (editingItemId) {
                // Update existing item
                let itemIndex = shopItems.findIndex(i => i.id === editingItemId);
                if (itemIndex !== -1) {
                    shopItems[itemIndex] = {
                        id: editingItemId,
                        name: name,
                        desc: desc,
                        category: category || 'General',
                        price: price,
                        purchased: shopItems[itemIndex].purchased || false
                    };
                }
                editingItemId = null;
                document.querySelector('.btn.primary').textContent = 'Add Reward';
            } else {
                // Add new item
                let item = {
                    id: Date.now(),
                    name: name,
                    desc: desc,
                    category: category || 'General',
                    price: price,
                    purchased: false
                };
                shopItems.push(item);
            }
            
            save();
            updateList();
            clearForm();
        }
        
        function deleteItem(id) {
            if (confirm('Delete this reward permanently?')) {
                shopItems = shopItems.filter(i => i.id !== id);
                save();
                updateList();
            }
        }
        
        function editItem(id) {
            let item = shopItems.find(i => i.id === id);
            if (item) {
                document.getElementById('itemName').value = item.name;
                document.getElementById('itemDesc').value = item.desc;
                document.getElementById('itemCategory').value = item.category;
                document.getElementById('itemPrice').value = item.price;
                editingItemId = id;
                document.querySelector('.btn.primary').textContent = 'Update Reward';
                document.getElementById('clearBtn').textContent = 'Cancel';
                document.getElementById('itemName').focus();
            }
        }
        
        function resetPurchased(id) {
            if (confirm('Mark this reward as available again?')) {
                let item = shopItems.find(i => i.id === id);
                if (item) {
                    item.purchased = false;
                    save();
                    updateList();
                }
            }
        }
        
        function useTemplate(name, desc, category, price) {
            clearForm();
            document.getElementById('itemName').value = name;
            document.getElementById('itemDesc').value = desc;
            document.getElementById('itemCategory').value = category;
            document.getElementById('itemPrice').value = price;
        }
        
        function clearForm() {
            document.getElementById('itemName').value = '';
            document.getElementById('itemDesc').value = '';
            document.getElementById('itemCategory').value = '';
            document.getElementById('itemPrice').value = '100';
            editingItemId = null;
            document.querySelector('.btn.primary').textContent = 'Add Reward';
            document.getElementById('clearBtn').textContent = 'Clear';
        }
        
        function updateList() {
            let list = document.getElementById('rewardList');
            if (shopItems.length === 0) {
                list.innerHTML = '<div class="empty">No rewards yet.<br>Use templates above or create your own.</div>';
                return;
            }
            
            list.innerHTML = shopItems.map(item => {
                let purchasedBadge = item.purchased ? '<span class="purchased-badge">✓ Purchased</span>' : '';
                let resetButton = item.purchased ? 
                    `<button class="btn btn-small" onclick="resetPurchased(${item.id})">Reset</button>` : '';
                
                return `
                    <div class="reward-item ${item.purchased ? 'purchased' : ''}">
                        <div class="reward-item-header">
                            <span class="reward-name">${item.name}${purchasedBadge}</span>
                            <span class="reward-price">${item.price} XP</span>
                        </div>
                        <div class="reward-category">${item.category}</div>
                        <div class="reward-desc">${item.desc}</div>
                        <div class="reward-actions" style="margin-top: 0.5rem;">
                            <button class="btn btn-small" onclick="editItem(${item.id})">Edit</button>
                            <button class="btn btn-small btn-danger" onclick="deleteItem(${item.id})">Delete</button>
                            ${resetButton}
                        </div>
                    </div>
                `;
            }).join('');
        }
        
        load();
    </script>
</body>
</html>
